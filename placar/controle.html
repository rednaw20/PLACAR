from zipfile import ZipFile
from pathlib import Path

# Caminho para salvar o arquivo zipado
zip_path = "/mnt/data/placar_beach_tennis.zip"

# Estrutura de arquivos para o placar e painel de controle
files = {
    "placar/index.html": """
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Placar Beach Tennis</title>
    <script defer src="script.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="scoreboard-container">
        <div class="top-bar">
            <div class="cronometro-container" id="cronometro-area"><span id="cronometro">00:00</span></div>
            <div class="categoria-container"><span id="categoria-text">FEMININO D</span></div>
        </div>
        <div class="team-row">
            <div class="team-names-container"><span id="team1-name">TIME 1</span></div>
            <div class="points-button" id="team1-points">0</div>
            <div class="sets-container" id="team1-sets">0</div>
            <div class="tiebreak-indicator" id="team1-tiebreak" style="display: none;">TB</div>
            <div class="serving-indicator" id="team1-serving" style="display: none;">Sacando</div>
        </div>
        <div class="team-row">
            <div class="team-names-container"><span id="team2-name">TIME 2</span></div>
            <div class="points-button" id="team2-points">0</div>
            <div class="sets-container" id="team2-sets">0</div>
            <div class="tiebreak-indicator" id="team2-tiebreak" style="display: none;">TB</div>
            <div class="serving-indicator" id="team2-serving" style="display: none;">Sacando</div>
        </div>
        <div class="bottom-bar">
            <strong><span id="circuito-text">CIRCUITO ARENA BEACH</span></strong>
        </div>
        <div class="break-point-indicator" id="break-point-area">BREAK POINT</div>
    </div>
</body>
</html>
""",
    "placar/script.js": """
const channel = new BroadcastChannel('beachTennisScore');

function formatTime(seconds) {
    const mins = String(Math.floor(seconds / 60)).padStart(2, '0');
    const secs = String(seconds % 60).padStart(2, '0');
    return `${mins}:${secs}`;
}

let cronometroInterval;
let segundos = 0;
let cronometroAtivo = false;

function startCronometro() {
    if (!cronometroAtivo) {
        cronometroAtivo = true;
        cronometroInterval = setInterval(() => {
            segundos++;
            document.getElementById('cronometro').textContent = formatTime(segundos);
        }, 1000);
    }
}

function stopCronometro() {
    clearInterval(cronometroInterval);
    cronometroAtivo = false;
    segundos = 0;
    document.getElementById('cronometro').textContent = '00:00';
}

channel.onmessage = ({ data }) => {
    const { type, value, team, change, action, score } = data;

    if (type === 'name') {
        const names = value.split('/');
        const el = document.getElementById(`team${team}-name`);
        el.innerHTML = names.join('<span></span>');
    }
    if (type === 'points') {
        document.getElementById(`team${team}-points`).textContent = value;
    }
    if (type === 'sets') {
        const el = document.getElementById(`team${team}-sets`);
        el.textContent = parseInt(el.textContent) + (change || 0);
    }
    if (type === 'topText') document.getElementById('categoria-text').textContent = value;
    if (type === 'bottomText') document.getElementById('circuito-text').textContent = value;

    if (type === 'serving') {
        document.getElementById('team1-serving').style.display = team === 1 ? 'block' : 'none';
        document.getElementById('team2-serving').style.display = team === 2 ? 'block' : 'none';
    }

    if (type === 'breakPoint') {
        const show = value;
        document.getElementById('cronometro-area').style.display = show ? 'none' : 'flex';
        document.getElementById('break-point-area').style.display = show ? 'flex' : 'none';
    }

    if (type === 'tiebreak') {
        const pointEl = document.getElementById(`team${team}-points`);
        const tbEl = document.getElementById(`team${team}-tiebreak`);
        pointEl.style.display = value ? 'none' : 'flex';
        tbEl.style.display = value ? 'flex' : 'none';
        tbEl.textContent = value ? (score || 'TB') : '';
    }

    if (action === 'startTimer') startCronometro();
    if (action === 'stopTimer') stopCronometro();
    if (action === 'resetGamePoints') {
        document.getElementById('team1-points').textContent = 0;
        document.getElementById('team2-points').textContent = 0;
    }
    if (action === 'resetScore') {
        document.getElementById('team1-points').textContent = 0;
        document.getElementById('team2-points').textContent = 0;
        document.getElementById('team1-sets').textContent = 0;
        document.getElementById('team2-sets').textContent = 0;
    }
};
""",
    "placar/style.css": """
body {
    background: #222;
    color: #eee;
    font-family: 'Open Sans', sans-serif;
}
.scoreboard-container {
    width: 700px;
    background: #333;
    padding: 20px;
    margin: auto;
}
.top-bar, .bottom-bar {
    display: flex;
    justify-content: space-between;
    background: #000c60;
    color: #39ff14;
    padding: 10px;
}
.team-row {
    display: grid;
    grid-template-columns: 3fr 1fr 1fr;
    background: #fff;
    color: #000c60;
    margin-top: 10px;
    padding: 10px;
}
.team-names-container span + span {
    display: block;
    margin-top: 5px;
    border-top: 1px solid #ccc;
}
.points-button, .sets-container {
    font-size: 2em;
    text-align: center;
}
.break-point-indicator {
    display: none;
    padding: 10px;
    background: #000c60;
    color: #39ff14;
    text-align: center;
}
""",
}

# Criar o arquivo ZIP
with ZipFile(zip_path, 'w') as zipf:
    for file_path, content in files.items():
        zipf.writestr(file_path, content)

zip_path
