<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Placar Beach Tennis</title>
  <style>
    body {
      font-family: 'Open Sans', sans-serif;
      margin: 0;
      background-color: #222;
      color: #eee;
      transform: scale(0.8);
      transform-origin: top left;
      width: 125%;
    }
    /* Cole aqui o restante das suas variáveis e estilos do :root e componentes do placar (você já tem isso definido e está mantido) */
  </style>
</head>
<body>
  <div class="scoreboard-container">
    <div class="top-bar">
      <div class="cronometro-container" id="cronometro-area">
        <span id="cronometro">00:00</span>
      </div>
      <div class="categoria-container">
        <span id="categoria-text">FEMININO D</span>
      </div>
    </div>

    <div class="team-row">
      <div class="team-names-container">
        <span id="team1-name">DIDÁ / GESIENE</span>
      </div>
      <div class="points-button" id="team1-points">0</div>
      <div class="sets-container" id="team1-sets">0</div>
      <div class="tiebreak-indicator" id="team1-tiebreak" style="display: none;">TB</div>
      <div class="serving-indicator" id="team1-serving" style="display: none;">Sacando</div>
    </div>

    <div class="team-row">
      <div class="team-names-container">
        <span id="team2-name">MATHEUS / ANA PAULA</span>
      </div>
      <div class="points-button" id="team2-points">0</div>
      <div class="sets-container" id="team2-sets">0</div>
      <div class="tiebreak-indicator" id="team2-tiebreak" style="display: none;">TB</div>
      <div class="serving-indicator" id="team2-serving" style="display: none;">Sacando</div>
    </div>

    <div class="bottom-bar">
      <strong><span id="circuito-text">CIRCUITO ARENA BEACH</span></strong>
    </div>
    <div class="break-point-indicator" id="break-point-area">BREAK POINT</div>
  </div>

  <script>
    const team1NameElement = document.getElementById('team1-name');
    const team2NameElement = document.getElementById('team2-name');
    const team1PointsButton = document.getElementById('team1-points');
    const team2PointsButton = document.getElementById('team2-points');
    const team1SetsContainer = document.getElementById('team1-sets');
    const team2SetsContainer = document.getElementById('team2-sets');
    const categoriaTextElement = document.getElementById('categoria-text');
    const circuitoTextElement = document.getElementById('circuito-text');
    const cronometroElement = document.getElementById('cronometro');
    const cronometroAreaElement = document.getElementById('cronometro-area');
    const breakPointAreaElement = document.getElementById('break-point-area');
    const team1TiebreakIndicator = document.getElementById('team1-tiebreak');
    const team2TiebreakIndicator = document.getElementById('team2-tiebreak');
    const team1ServingIndicator = document.getElementById('team1-serving');
    const team2ServingIndicator = document.getElementById('team2-serving');

    let cronometroInterval;
    let segundos = 0;
    let cronometroAtivo = false;
    let tiebreakAtivo = false;

    function formatTime(segundos) {
      const minutos = Math.floor(segundos / 60).toString().padStart(2, '0');
      const secs = (segundos % 60).toString().padStart(2, '0');
      return `${minutos}:${secs}`;
    }

    function startCronometro() {
      if (!cronometroAtivo) {
        cronometroAtivo = true;
        cronometroInterval = setInterval(() => {
          segundos++;
          cronometroElement.textContent = formatTime(segundos);
        }, 1000);
      }
    }

    function stopCronometro() {
      clearInterval(cronometroInterval);
      cronometroAtivo = false;
      segundos = 0;
      cronometroElement.textContent = '00:00';
    }

    const channel = new BroadcastChannel('beachTennisScore');

    channel.onmessage = (event) => {
      const data = event.data;

      switch (data.type) {
        case 'name':
          const names = data.value.split('/');
          if (data.team === 1) {
            team1NameElement.innerHTML = names.join('<span></span>');
          } else {
            team2NameElement.innerHTML = names.join('<span></span>');
          }
          break;
        case 'points':
          if (!tiebreakAtivo) {
            if (data.team === 1) team1PointsButton.textContent = data.value;
            else if (data.team === 2) team2PointsButton.textContent = data.value;
          }
          break;
        case 'sets':
          if (data.team === 1)
            team1SetsContainer.textContent = parseInt(team1SetsContainer.textContent) + (data.change || 0);
          else
            team2SetsContainer.textContent = parseInt(team2SetsContainer.textContent) + (data.change || 0);
          break;
        case 'topText':
          categoriaTextElement.textContent = data.value;
          break;
        case 'bottomText':
          circuitoTextElement.textContent = data.value;
          break;
        case 'serving':
          team1ServingIndicator.style.display = data.team === 1 ? 'block' : 'none';
          team2ServingIndicator.style.display = data.team === 2 ? 'block' : 'none';
          break;
        case 'breakPoint':
          cronometroAreaElement.style.display = data.value ? 'none' : 'flex';
          breakPointAreaElement.style.display = data.value ? 'flex' : 'none';
          break;
        case 'tiebreak':
          tiebreakAtivo = data.value;
          if (data.team === 1) {
            team1PointsButton.style.display = data.value ? 'none' : 'flex';
            team1TiebreakIndicator.style.display = data.value ? 'flex' : 'none';
            team1TiebreakIndicator.textContent = data.value ? (data.score || 'TB') : '';
          } else {
            team2PointsButton.style.display = data.value ? 'none' : 'flex';
            team2TiebreakIndicator.style.display = data.value ? 'flex' : 'none';
            team2TiebreakIndicator.textContent = data.value ? (data.score || 'TB') : '';
          }
          break;
      }

      if (data.action === 'startTimer') startCronometro();
      else if (data.action === 'stopTimer') stopCronometro();
      else if (data.action === 'resetGamePoints') {
        team1PointsButton.textContent = 0;
        team2PointsButton.textContent = 0;
      } else if (data.action === 'resetScore') {
        team1PointsButton.textContent = 0;
        team2PointsButton.textContent = 0;
        team1SetsContainer.textContent = 0;
        team2SetsContainer.textContent = 0;
      }
    };
  </script>
</body>
</html>
